import{a as F}from"./avatar-1-BeeGmpGQ.js";import{a as U}from"./axios-DkDr-_XN.js";import{i as f,H as j,r as v,o as y,c as g,b as e,w as a,u as o,j as E,F as z,a as u,N as m,M as i}from"./index-Csy_03Ik.js";import{V as C,a as w,b as k,d as x,c as I,e as P}from"./VCard-Dn6rlqdV.js";import{V as D}from"./VDialog-Dlc5bKtd.js";import{V}from"./VTextField-C2KP5el_.js";import{V as S}from"./VFileInput-X74q7RTt.js";import"./VGrid-CkWBtd8r.js";import"./VImg-AgknyUsB.js";import"./dialog-transition-BELgG3Ok.js";import"./index-Duozb8DO.js";import"./VInput-D2rLtPSR.js";const J=u("p",null,"My Info",-1),O=["src"],R=["src"],M={class:"d-flex",style:{"margin-top":"10px"}},q={class:"d-flex",style:{"margin-top":"10px"}},G={class:"d-flex",style:{"margin-top":"10px"}},H={class:"d-flex",style:{"margin-top":"10px"}},L={class:"ml-auto"},re={__name:"mypage",setup(K){f("serverAddress");const T=f("userProfileAddress"),d=f("userAddress"),p=f("auth");let h="Bearer ";h=h+p;const c=j(),l=v({username:"",email:"",password:"",storeFileName:""});async function _(){const n=await fetch(`http://${d}/api/getinfo`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${p}`},credentials:"include"});if(!n.ok)alert("실패!");else{const t=await n.json();l.value.username=t[0],l.value.email=t[1],l.value.storeFileName=t[2]}}async function b(){(await fetch(`http://${d}/api/update/username`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${p}`},body:JSON.stringify(l.value.username),credentials:"include"})).ok?(alert("성공"),c.push("/logout")):alert("실패!")}async function A(){(await fetch(`http://${d}/api/update/email`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${p}`},body:JSON.stringify(l.value.email),credentials:"include"})).ok?(alert("성공"),c.push("/logout")):alert("실패!")}async function $(){(await fetch(`http://${d}/api/update/password`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${p}`},body:JSON.stringify(l.value.password),credentials:"include"})).ok?(alert("성공"),c.push("/logout")):alert("실패!")}function N(){var n=new FormData,t=document.querySelectorAll("#user-image-input");t.forEach(s=>{s.files.length>0&&n.append("files",s.files[0])}),U.put(`http://${d}/api/update/image`,n,{headers:{"Content-Type":"multipart/form-data",Authorization:h}}).then(()=>{_(),r.value=!1}).catch(()=>{console.error("파일 전송 실패")})}async function B(){(await fetch(`http://${d}/api/delete`,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:`Bearer ${p}`},credentials:"include"})).ok?(alert("성공"),c.push("/logout")):alert("실패")}_();const r=v(!1);return(n,t)=>(y(),g(z,null,[e(C,null,{default:a(()=>[e(w,{cols:"12",md:"8",class:"mb-4"},{default:a(()=>[e(k,{class:"position-relative"},{default:a(()=>[e(x,null,{default:a(()=>[u("div",null,[J,o(l).storeFileName?(y(),g("img",{key:1,onClick:t[1]||(t[1]=s=>r.value=!0),class:"follow-propile-img",src:o(T)+o(l).storeFileName},null,8,R)):(y(),g("img",{key:0,onClick:t[0]||(t[0]=s=>r.value=!0),class:"follow-propile-img",src:o(F)},null,8,O)),u("div",M,[e(V,{id:"username",modelValue:o(l).username,"onUpdate:modelValue":t[2]||(t[2]=s=>o(l).username=s),placeholder:"이름",label:"이름"},null,8,["modelValue"]),e(m,{type:"submit",onClick:b,style:{"margin-top":"0.5%","margin-left":"3%"}},{default:a(()=>[i(" update ")]),_:1})]),u("div",q,[e(V,{id:"email",modelValue:o(l).email,"onUpdate:modelValue":t[3]||(t[3]=s=>o(l).email=s),placeholder:"메일",label:"메일"},null,8,["modelValue"]),e(m,{type:"submit",onClick:A,style:{"margin-top":"0.5%","margin-left":"3%"}},{default:a(()=>[i(" update ")]),_:1})]),u("div",G,[e(V,{id:"password",modelValue:o(l).password,"onUpdate:modelValue":t[4]||(t[4]=s=>o(l).password=s),placeholder:"비밀번호",label:"비밀번호"},null,8,["modelValue"]),e(m,{type:"submit",onClick:$,style:{"margin-top":"0.5%","margin-left":"3%"}},{default:a(()=>[i(" update ")]),_:1})]),u("div",H,[u("div",L,[e(m,{type:"submit",onClick:B},{default:a(()=>[i(" 탈퇴 ")]),_:1})])])])]),_:1})]),_:1})]),_:1})]),_:1}),e(D,{modelValue:o(r),"onUpdate:modelValue":t[6]||(t[6]=s=>E(r)?r.value=s:null),"max-width":"50%"},{default:a(()=>[e(k,null,{default:a(()=>[e(I,null,{default:a(()=>[i("User Image Edit")]),_:1}),e(x,null,{default:a(()=>[e(w,null,{default:a(()=>[e(S,{id:"user-image-input",placeholder:"이름",label:"이름"})]),_:1}),e(C,null,{default:a(()=>[e(m,{onClick:N,class:"me-5",style:{"margin-top":"10px"}},{default:a(()=>[i(" Submit ")]),_:1})]),_:1})]),_:1}),e(P,null,{default:a(()=>[e(m,{color:"primary",onClick:t[5]||(t[5]=s=>r.value=!1)},{default:a(()=>[i("Close")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}};export{re as default};
