import{i as l,r as C,o as c,e as _,w as a,b as t,M as y,t as A,u as i,a as V,h as T,H as z,c as g,j as E,F as j,L as I,N as b,P as D}from"./index-Csy_03Ik.js";import{c as B,d as x,b as k,V as G,a as v,e as U}from"./VCard-Dn6rlqdV.js";import{V as F}from"./VDialog-Dlc5bKtd.js";import{V as M}from"./VTextField-C2KP5el_.js";import"./VGrid-CkWBtd8r.js";import"./VImg-AgknyUsB.js";import"./dialog-transition-BELgG3Ok.js";import"./index-Duozb8DO.js";import"./VInput-D2rLtPSR.js";const O=V("span",null," Created New Chatting Room",-1),L={__name:"ChatRoomSummary",props:{chatRoom:Object},setup(R){const p=l("chatAddress"),$=l("userAddress"),d=l("auth"),h=R;async function w(){const n=await fetch(`http://${$}/api/getuserid`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${d}`},credentials:"include"});if(!n.ok)alert("인증에 실패하였습니다.");else return n.json()}const r=C([]);async function f(){const n=await w(),u=await fetch(`http://${p}/api/chat/read/recent/${h.chatRoom.id}/${n}`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${d}`},credentials:"include"});u.ok?r.value=await u.json():alert("실패!")}return console.log(r.value),f(),(n,u)=>(c(),_(k,{rounded:"pill"},{default:a(()=>[t(B,null,{default:a(()=>[y(A(R.chatRoom.name),1)]),_:1}),i(r).content?(c(),_(x,{key:0},{default:a(()=>[V("span",null,A(i(r).content),1)]),_:1})):T("",!0),i(r).content?T("",!0):(c(),_(x,{key:1},{default:a(()=>[O]),_:1}))]),_:1}))}},ee={__name:"chathome",setup(R){l("serverAddress");const p=l("chatAddress"),$=l("userAddress"),d=l("auth");async function h(){const s=await fetch(`http://${$}/api/getuserid`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${d}`},credentials:"include"});if(!s.ok)alert("인증에 실패하였습니다.");else return s.json()}const w=z(),r=C([]);async function f(){const s=await h(),e=await fetch(`http://${p}/api/chatroomuser/read/${s}`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${d}`},credentials:"include"});e.ok?r.value=await e.json():alert("실패!")}const n=C({name:""});async function u(){const s=await h(),e={name:n.value.name};(await fetch(`http://${p}/api/chatroom/create/${s}`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${d}`},body:JSON.stringify(e),credentials:"include"})).ok?f():alert("실패!")}async function N(s){w.push({path:`/chatroom/${s}`}).then(()=>{window.location.reload()})}f();const m=C(!1);return(s,e)=>(c(),g(j,null,[t(G,null,{default:a(()=>[t(v,{cols:"12",md:"8",class:"mb-4"},{default:a(()=>[(c(!0),g(j,null,I(i(r),(o,S)=>(c(),g("div",{key:S},[V("div",null,[t(L,{chatRoom:o.chatRoom,style:{"margin-bottom":"20px"},onClick:P=>N(o.chatRoom.id)},null,8,["chatRoom","onClick"])])]))),128))]),_:1}),t(v,{cols:"12",md:"4"},{default:a(()=>[t(k,{title:"Create Chat Room",onClick:e[0]||(e[0]=o=>m.value=!0),style:{"margin-bottom":"20px"}})]),_:1})]),_:1}),t(F,{modelValue:i(m),"onUpdate:modelValue":e[4]||(e[4]=o=>E(m)?m.value=o:null),"max-width":"50%"},{default:a(()=>[t(k,null,{default:a(()=>[t(B,null,{default:a(()=>[y("Create Chat Room")]),_:1}),V("form",{onSubmit:e[2]||(e[2]=D(o=>u(),["prevent"]))},[t(v,null,{default:a(()=>[t(M,{id:"name",modelValue:i(n).name,"onUpdate:modelValue":e[1]||(e[1]=o=>i(n).name=o),placeholder:"채팅방 이름",label:"채팅방 이름"},null,8,["modelValue"]),t(b,{type:"submit",class:"me-5",style:{"margin-top":"10px"}},{default:a(()=>[y(" Submit ")]),_:1})]),_:1})],32),t(U,null,{default:a(()=>[t(b,{color:"primary",onClick:e[3]||(e[3]=o=>m.value=!1)},{default:a(()=>[y("Close")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}};export{ee as default};
