import{i as I,r as c,H as ot,E as L,o as p,e as b,w as n,b as s,u as t,a,t as d,V as G,j as nt,M as _,c as y,h as B,F as N,L as F,N as O,I as at,a4 as it}from"./index-Csy_03Ik.js";import{_ as rt}from"./Reply-DcX9_dpw.js";import{a as lt}from"./avatar-1-BeeGmpGQ.js";import{a as ct}from"./index-Duozb8DO.js";import{d as R,a as v,c as pt,e as dt,b as ut}from"./VCard-Dn6rlqdV.js";import{V as ft,a as ht,b as U,c as Y,e as mt}from"./VSpacer-B8EKNrvY.js";import{V as _t}from"./VDivider-COcjAoGG.js";const yt={class:"post-header"},gt={style:{"font-weight":"500","font-size":"small",display:"flex","align-items":"center"}},$t={style:{"margin-right":"10px"}},vt=["src"],kt={style:{"margin-right":"5px"}},Ct=a("span",null," • ",-1),wt={style:{"margin-left":"5px"}},Tt={class:"post-title"},Vt={key:0},It=["innerHTML"],Bt={key:1},jt=["innerHTML"],xt={class:"post-interactions-item",style:{"margin-left":"10px","margin-right":"10px"}},At={class:"post-interactions-item",style:{"margin-left":"10px","margin-right":"10px"}},Ht={__name:"PostModal",props:{post:Object},setup(q){I("serverAddress");const u=I("postAddress"),D=I("userAddress"),l=I("auth");async function k(){const o=await fetch(`http://${D}/api/getuserid`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${l}`},credentials:"include"});if(!o.ok)alert("인증에 실패하였습니다.");else return o.json()}const i=c([]),j=c([]);async function J(){const o=await k(),e=await fetch(`http://${u}/api/post/read/${f.post.postId}/${o}`,{headers:{"Content-Type":"application/json",Authorization:`Bearer ${l}`}});e.ok?(i.value=await e.json(),tt(i.value.userId)):alert("인증에 실패하였습니다.")}J();const K=function(o){const e=new Date(o),m=e.getFullYear(),w=e.getMonth()+1,T=e.getDate(),r=e.getHours(),V=e.getMinutes(),$=e.getSeconds();return`${m}-${w}-${T} ${r}:${V}:${$}`},E=c([]),M=c([]),g=c(!1),h=c(!0),x=c(!1),C=c("펼치기");function S(){g.value=!g.value,g.value==!0?C.value="접기":C.value="펼치기"}const f=q;async function Q(){const o=await k();(await fetch(`http://${u}/api/postlike/check/${f.post.postId}/${o}`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${l}`},credentials:"include"})).ok?H():console.error()}async function W(){const o=await k();(await fetch(`http://${u}/api/poststar/check/${f.post.postId}/${o}`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${l}`},credentials:"include"})).ok?P():console.error()}async function H(){const o=await fetch(`http://${u}/api/postlike/read/${f.post.postId}`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${l}`},credentials:"include"});o.ok?E.value=await o.json():console.error()}async function P(){const o=await fetch(`http://${u}/api/poststar/read/${f.post.postId}`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${l}`},credentials:"include"});o.ok?M.value=await o.json():console.error()}async function X(o){const e=await k();confirm("삭제하시겠습니까?")&&((await fetch(`http://${u}/api/post/delete/${o}/${e}`,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:`Bearer ${l}`},credentials:"include"})).ok?(alert("삭제되었습니다."),window.location.reload()):(console.error(),alert("삭제할 수 없습니다.")))}const A=c([]);async function Z(){const o=await fetch(`http://${u}/api/tagpost/read/${f.post.postId}`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${l}`},credentials:"include"});if(!o.ok)console.error();else{const e=await o.text();A.value=e.split()}}async function tt(o){const e=await fetch(`http://${D}/api/whoAreYou/${o}`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${l}`},credentials:"include"});e.ok?(j.value=await e.json(),console.log("user1234",j)):alert("인증에 실패하였습니다.")}const et=ot();function st(o){et.push({path:`/updatepost/${o}`})}return H(),P(),Z(),(o,e)=>{const m=L("VIconBtn"),w=L("font-awesome-icon"),T=L("IConBtn");return p(),b(ut,{class:"position-relative"},{default:n(()=>[s(t(R),null,{default:n(()=>[s(t(v),{class:"mb-2"},{default:n(()=>[s(t(v),{class:"post-details"},{default:n(()=>[a("div",yt,[s(t(v),{class:"post-header"},{default:n(()=>[a("div",gt,[a("span",$t,[a("img",{class:"propile-img",src:t(lt)},null,8,vt)]),a("span",kt,d(t(j).username),1),Ct,a("span",wt,d(K(t(i).postCreateDt)),1),s(m,{style:{"margin-left":"auto"}},{default:n(()=>[s(t(G),{ref:"postoptionactivator",icon:"ri-more-line",style:{cursor:"pointer"}},null,512),s(ft,{modelValue:t(x),"onUpdate:modelValue":e[2]||(e[2]=r=>nt(x)?x.value=r:null),activator:o.$refs.postoptionactivator,location:"bottom end",width:"auto",offset:"5px"},{default:n(()=>[s(ht,null,{default:n(()=>[s(U,{link:""},{default:n(()=>[s(Y,{onClick:e[0]||(e[0]=r=>st(t(i).postId)),style:{"font-size":"small"}},{default:n(()=>[_(" 수정 ")]),_:1})]),_:1}),s(U,{link:""},{default:n(()=>[s(Y,{onClick:e[1]||(e[1]=r=>X(t(i).postId)),style:{"font-size":"small"}},{default:n(()=>[_(" 삭제 ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","activator"])]),_:1})])]),_:1})]),a("div",Tt,[s(pt,{style:{"font-weight":"700"}},{default:n(()=>[_(d(t(i).postTitle),1)]),_:1})]),s(t(_t)),s(t(v),{class:"post-content, mt-2",style:{"margin-left":"5px"}},{default:n(()=>{var r,V;return[t(g)?B("",!0):(p(),y("div",Vt,[a("div",{class:"mb-1",innerHTML:((r=t(i).postContent)==null?void 0:r.length)>100?t(i).postContent.slice(0,100)+"...":t(i).postContent},null,8,It),((V=t(i).postContent)==null?void 0:V.length)>100?(p(),b(m,{key:0,class:"detailContent",onClick:S},{default:n(()=>[_(d(t(C)),1)]),_:1})):B("",!0),(p(!0),y(N,null,F(t(A),($,z)=>(p(),y("div",{key:z,class:"mt-4",style:{color:"#8c57ff"}},d($),1))),128))])),t(g)?(p(),y("div",Bt,[a("div",{class:"mb-1",innerHTML:t(i).postContent},null,8,jt),t(i).postContent.length>100?(p(),b(m,{key:0,class:"detailContent",onClick:S},{default:n(()=>[_(d(t(C)),1)]),_:1})):B("",!0),(p(!0),y(N,null,F(t(A),($,z)=>(p(),y("div",{key:z,class:"mt-4",style:{color:"#8c57ff"}},d($),1))),128))])):B("",!0)]}),_:1}),s(t(v),{style:{"margin-left":"6px"}},{default:n(()=>[s(T,{onClick:Q,style:{cursor:"pointer"}},{default:n(()=>[s(w,{icon:["far","thumbs-up"]})]),_:1}),a("span",xt,d(t(E)),1),s(T,{onClick:W,style:{cursor:"pointer"}},{default:n(()=>[s(w,{icon:["far","star"]})]),_:1}),a("span",At,d(t(M)),1)]),_:1}),s(dt,null,{default:n(()=>[s(O,{onClick:e[3]||(e[3]=r=>h.value=!t(h))},{default:n(()=>[_(" 댓글 ")]),_:1}),s(mt),s(O,{icon:"",size:"small",onClick:e[4]||(e[4]=r=>h.value=!t(h))},{default:n(()=>[s(t(G),{icon:t(h)?"ri-arrow-up-s-line":"ri-arrow-down-s-line"},null,8,["icon"])]),_:1})]),_:1}),s(ct,null,{default:n(()=>[at(a("div",null,[s(t(R),null,{default:n(()=>[s(rt,{postob:f.post},null,8,["postob"])]),_:1})],512),[[it,t(h)]])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}}};export{Ht as _};
