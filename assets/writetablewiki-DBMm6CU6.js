import{_ as B,a as N,b as U}from"./ViewWikiStarRank-DHqijTNx.js";import{_ as z}from"./wikieditor-D8LS6Czb.js";import{a as y}from"./axios-DkDr-_XN.js";import{H as E,a7 as F,i,r as R,o as G,e as S,w as a,b as t,a as f,u as n,N as w,M as V}from"./index-Csy_03Ik.js";import{V as W,b as u,d as D,a as r}from"./VCard-Dn6rlqdV.js";import{V as k}from"./VTextField-C2KP5el_.js";import"./VTable-CVQIvV2I.js";import"./VGrid-CkWBtd8r.js";import"./VImg-AgknyUsB.js";import"./VInput-D2rLtPSR.js";import"./index-Duozb8DO.js";const H=f("p",null,"Wiki 작성",-1),et={__name:"writetablewiki",props:{tableId:String},setup($){const _=E(),b=F();i("serverAddress");const h=i("wikiAddress"),I=i("userAddress"),x=i("tableAddress"),c=i("auth"),g=$;async function m(){const l=await fetch(`http://${I}/api/getuserid`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${c}`},credentials:"include"});if(!l.ok)alert("인증에 실패하였습니다.");else return l.json()}let d="Bearer ";d=d+c;const o=R({title:"",content:"",category:"",userIds:[]});async function T(l){const e=await m(),s=await fetch(`http://${x}/api/tableuser/teams/${g.tableId}/${e}`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${c}`},credentials:"include"});s.ok?(await s.json()).forEach(function(j){l.value.userIds.push(j)}):alert("인증에 실패하였습니다.")}v();async function v(){if(b.params.id){const l=await m();y.get(`http://${h}/api/wiki/read/${b.params.id}/${l}`,{headers:{Authorization:d}}).then(e=>{o.value.title=e.data.wikiTitle,o.value.content=e.data.wikiContent,o.value.category=e.data.category.name})}}async function A(){const l={"Content-Type":"application/json",Authorization:d},e=await m();o.value.userIds=[],await T(o),console.log(o.value.userIds);const s=JSON.stringify(o.value);y.post(`http://${h}/api/wiki/create/${g.tableId}/${e}`,s,{headers:l}).then(p=>{_.go(-1)}).catch(p=>{console.error("에러 발생:",p)})}const C=()=>{_.go(-1)};return(l,e)=>(G(),S(W,null,{default:a(()=>[t(r,{cols:"12",md:"8",class:"mb-4"},{default:a(()=>[t(u,{class:"position-relative"},{default:a(()=>[t(D,null,{default:a(()=>[f("div",null,[H,t(r,null,{default:a(()=>[t(k,{id:"title",modelValue:n(o).title,"onUpdate:modelValue":e[0]||(e[0]=s=>n(o).title=s),placeholder:"제목",label:"제목"},null,8,["modelValue"])]),_:1}),t(r,null,{default:a(()=>[f("div",null,[t(z,{modelValue:n(o).content,"onUpdate:modelValue":e[1]||(e[1]=s=>n(o).content=s)},null,8,["modelValue"])])]),_:1}),t(r,null,{default:a(()=>[t(k,{id:"category",modelValue:n(o).category,"onUpdate:modelValue":e[2]||(e[2]=s=>n(o).category=s),placeholder:"카테고리",label:"카테고리"},null,8,["modelValue"])]),_:1}),t(r,{cols:"12"},{default:a(()=>[t(w,{onClick:A,type:"submit",class:"me-5"},{default:a(()=>[V(" 작성 ")]),_:1}),t(w,{onClick:C,type:"button"},{default:a(()=>[V("취소")]),_:1})]),_:1})])]),_:1})]),_:1})]),_:1}),t(r,{cols:"12",md:"4"},{default:a(()=>[t(u,{title:"추천순",style:{"margin-bottom":"20px"}},{default:a(()=>[t(B,{style:{"margin-bottom":"20px"}})]),_:1}),t(u,{title:"즐겨찾기순",style:{"margin-bottom":"20px"}},{default:a(()=>[t(N,{style:{"margin-bottom":"20px"}})]),_:1}),t(u,{title:"최신순",style:{"margin-bottom":"20px"}},{default:a(()=>[t(U,{style:{"margin-bottom":"20px"}})]),_:1})]),_:1})]),_:1}))}};export{et as default};
