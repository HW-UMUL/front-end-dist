import{_ as ie,i as L,H as ne,r as n,l as O,o as p,e as Y,w as v,b as u,a as e,M as Q,I as q,O as J,c as f,F as M,L as D,t as w,n as b,u as g,P as x,Q as re,R as ue}from"./index-Csy_03Ik.js";import{_ as de}from"./GetName-ChMEjk5Y.js";import{_ as ce,a as ve,b as pe}from"./ViewWikiStarRank-DHqijTNx.js";import{a as K}from"./axios-DkDr-_XN.js";import{a as X,b as V,c as he,V as _e}from"./VCard-Dn6rlqdV.js";import"./VTable-CVQIvV2I.js";import"./VGrid-CkWBtd8r.js";import"./VImg-AgknyUsB.js";const d=m=>(re("data-v-1bfd4016"),m=m(),ue(),m),fe={style:{"margin-bottom":"20px"}},ge=d(()=>e("option",{value:"5",selected:""}," 5개씩 보기 ",-1)),me=d(()=>e("option",{value:"10"},"10개씩 보기",-1)),ye=d(()=>e("option",{value:"20"},"20개씩 보기",-1)),ke=[ge,me,ye],we=d(()=>e("option",{value:"",selected:""}," 카테고리 선택 ",-1)),be=["value"],xe=d(()=>e("br",null,null,-1)),Ce=d(()=>e("br",null,null,-1)),$e={class:"wikititle",border:"0",style:{"border-spacing":"5px",width:"100%","max-height":"300px","overflow-y":"auto"}},Ie=d(()=>e("tr",{style:{"font-weight":"bold"}},[e("td",{width:"10%",style:{"padding-left":"10px"}}," 번호 "),e("td",{style:{"padding-left":"10px"},width:"55%"}," 제목 "),e("td",{align:"center",width:"10%"}," 사용자 "),e("td",{align:"center",width:"25%"}," 작성일 ")],-1)),Be=d(()=>e("tr",null,[e("td",{colspan:"6"},[e("hr")])],-1)),Le={height:"40"},Me={style:{"padding-left":"20px"},width:"10%"},Ve={width:"50%"},Ae=["onClick"],Se={width:"20%",align:"center"},Pe={width:"20%",align:"center"},Te=d(()=>e("tr",null,[e("td",{colspan:"4"},[e("hr")])],-1)),je=d(()=>e("br",null,null,-1)),De={style:{display:"flex",gap:"5px","justify-content":"center"}},Ne={class:"pagination"},ze=["onClick"],Ee={__name:"MyWikiList",setup(m){L("serverAddress");const A=L("wikiAddress"),N=L("userAddress"),z=L("auth");async function Z(){const a=await fetch(`http://${N}/api/getuserid`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${z}`},credentials:"include"});if(!a.ok)alert("인증에 실패하였습니다.");else return a.json()}let C="Bearer ";C=C+z;const ee=ne(),S=n([]),h=n([]),E=n([]),r=n([]),o=n("10");let s=n(0),$=10;const y=n([]);let i=n(0),F=n(!0),R=n(!0),U=n(!0),W=n(!0);const I=()=>Math.floor(s.value/$)*$,te=()=>{y.value=[],r.value.length%o.value==0?i.value=r.value.length/o.value-1:i.value=Math.ceil(r.value.length/o.value)-1;let a=I();for(let t=0;t<$;t++)i.value>=a&&(y.value.push(a),a++)},ae=()=>{y.value=[],r.value.length%o.value==0?i.value=r.value.length/o.value-1:i.value=Math.ceil(h.value.length/o.value)-1;let a=I();for(let t=0;t<$;t++)i.value>=a&&(y.value.push(a),a++)},P=async()=>{var a;try{const t=await Z(),l=await K.get(`http://${A}/api/wiki/read/my/${t}`,{headers:{Authorization:C}});r.value=l.data,E.value=l.data,h.value=[],S.value=[];const c=o.value*s.value,j=Math.min(c+o.value,r.value.length),H=[];for(let _=c;_<j;_++){const oe=await K.get(`http://${A}/api/wikilog/readall/${r.value[_].wikiId}/${t}`,{headers:{Authorization:C},withCredentials:!0});H.push((a=oe.data[0])==null?void 0:a.date.substring(0,10)),h.value.push(r.value[_])}await Promise.all(H).then(_=>{S.value=_}),te(),T()}catch(t){console.error("Error fetching data:",t)}};P();const G=a=>{s.value=a,P()};O(o,(a,t)=>{s.value=0,P()});const T=()=>{F.value=s.value==0,R.value=s.value==0,U.value=s.value==i.value,W.value=s.value==i.value};O(s,(a,t)=>{T()});const B=a=>{let t=parseInt(s.value);a=="first"?t=0:a=="last"?t=i.value:a=="prev"?(t=I()-1,t<0&&(t=0)):(t=I()+10,t>=i.value&&(t=i.value)),G(t)};function le(a){ee.push({name:"readwiki",params:{id:a}})}const k=n(""),se=()=>{console.log("Selected Category ID:",k.value),k.value===""?h.value=r.value.slice(0,o.value):h.value=r.value.filter(a=>a.category.id===k.value).slice(0,o.value),i.value=Math.ceil(h.value.length/o.value)-1,s.value=0,s.value>i.value&&(s.value=i.value),ae(),T()};return(a,t)=>(p(),Y(_e,null,{default:v(()=>[u(X,{cols:"12",md:"8",class:"mb-4"},{default:v(()=>[u(V,null,{default:v(()=>[e("div",fe,[u(he,{color:""},{default:v(()=>[Q("Wiki List")]),_:1})]),q(e("select",{"onUpdate:modelValue":t[0]||(t[0]=l=>o.value=l),style:{"margin-left":"10px"}},ke,512),[[J,o.value]]),Q("  "),q(e("select",{"onUpdate:modelValue":t[1]||(t[1]=l=>k.value=l),onChange:se},[we,(p(!0),f(M,null,D(E.value,(l,c)=>(p(),f("option",{key:c,value:l.category.id},w(l.category.name),9,be))),128))],544),[[J,k.value]]),xe,Ce,e("table",$e,[Ie,Be,(p(!0),f(M,null,D(h.value,(l,c)=>(p(),f(M,{key:c},[e("tr",Le,[e("td",Me,w(l.wikiId),1),e("td",Ve,[e("button",{type:"button",onClick:j=>le(l.wikiId),style:{color:"#905dff"}},w(l.wikiTitle),9,Ae)]),e("td",Se,[u(de,{userId:l.userId},null,8,["userId"])]),e("td",Pe,w(S.value[c]),1)]),Te],64))),128))]),je,e("div",De,[e("ul",Ne,[e("li",{class:b(["page-item",{disabled:g(F)}])},[e("a",{class:"page-link",href:"#",onClick:t[2]||(t[2]=x(l=>B("first"),["prevent"]))},"처음")],2),e("li",{class:b(["page-item",{disabled:g(R)}])},[e("a",{class:"page-link",href:"#",onClick:t[3]||(t[3]=x(l=>B("prev"),["prevent"]))}," < 이전 ")],2),(p(!0),f(M,null,D(y.value,(l,c)=>(p(),f("li",{key:`list-${c}`,class:b(["page-item",{active:l==g(s),bold:l==g(s)}])},[e("a",{class:"page-link",href:"#",onClick:x(j=>G(l),["prevent"])},w(l+1),9,ze)],2))),128)),e("li",{class:b(["page-item",{disabled:g(U)}])},[e("a",{class:"page-link",href:"#",onClick:t[4]||(t[4]=x(l=>B("next"),["prevent"]))}," 다음 > ")],2),e("li",{class:b(["page-item",{disabled:g(W)}])},[e("a",{class:"page-link",href:"#",onClick:t[5]||(t[5]=x(l=>B("last"),["prevent"]))},"마지막")],2)])])]),_:1})]),_:1}),u(X,{cols:"12",md:"4"},{default:v(()=>[u(V,{title:"추천순",style:{"margin-bottom":"20px"}},{default:v(()=>[u(ce,{style:{"margin-bottom":"20px"}})]),_:1}),u(V,{title:"즐겨찾기순",style:{"margin-bottom":"20px"}},{default:v(()=>[u(ve,{style:{"margin-bottom":"20px"}})]),_:1}),u(V,{title:"최신순",style:{"margin-bottom":"20px"}},{default:v(()=>[u(pe,{style:{"margin-bottom":"20px"}})]),_:1})]),_:1})]),_:1}))}},Fe=ie(Ee,[["__scopeId","data-v-1bfd4016"]]),Ke={__name:"mywikis",setup(m){return(A,N)=>(p(),Y(Fe))}};export{Ke as default};
