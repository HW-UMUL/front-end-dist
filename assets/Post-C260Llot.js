import{i as h,r,H as tt,E as D,o as y,c as k,a as n,b as s,w as a,u as e,t as c,V as et,j as st,M as _,e as ot,h as $,aL as H,P as nt}from"./index-Csy_03Ik.js";import{_ as at}from"./PostModal-DYxFwaA8.js";import{a as it}from"./avatar-1-BeeGmpGQ.js";import{V as lt,a as rt,b as R,c as G}from"./VSpacer-B8EKNrvY.js";import{d as ct,a as C,c as dt,b as pt}from"./VCard-Dn6rlqdV.js";import{V as ut}from"./VDivider-COcjAoGG.js";const ft={class:"post-header"},mt={style:{"font-weight":"500","font-size":"small",display:"flex","align-items":"center"}},ht={style:{"margin-right":"10px"}},yt=["src"],_t={style:{"margin-right":"5px"}},gt=n("span",null," • ",-1),vt={style:{"margin-left":"5px"}},kt={class:"post-title"},$t={key:0},Ct=["innerHTML"],wt={class:"mt-4"},It={style:{color:"#8c57ff"}},xt={key:1},Tt=["innerHTML"],Vt={class:"mt-4"},zt={style:{color:"#8c57ff"}},At={class:"post-interactions-item",style:{"margin-left":"10px","margin-right":"10px"}},Bt={class:"post-interactions-item",style:{"margin-left":"10px","margin-right":"10px"}},jt={style:{"margin-left":"auto"}},Dt={key:0,class:"modal-body"},Ht={__name:"Post",props:{post:Object,index:Object},setup(l){h("serverAddress");const f=h("postAddress"),b=h("userAddress"),d=h("auth"),N=h("userProfileAddress");h("defaultProfileAddress");async function A(){const o=await fetch(`http://${b}/api/getuserid`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${d}`},credentials:"include"});if(!o.ok)alert("인증에 실패하였습니다.");else return o.json()}const O=function(o){const t=new Date(o),i=t.getFullYear(),T=t.getMonth()+1,V=t.getDate(),u=t.getHours(),z=t.getMinutes(),Z=t.getSeconds();return`${i}-${T}-${V} ${u}:${z}:${Z}`},L=r([]),M=r([]),g=r(!1);r(!1);const B=r(!1);let w=0;const v=r(!1),m=r(null);function U(){m.value&&(w=window.getComputedStyle(m.value).zIndex,m.value.style.zIndex=1e3),v.value=!0}function Y(){m.value&&w!==null&&(m.value.style.zIndex=w,w=null),v.value=!1}const I=r("펼치기");function E(){g.value=!g.value,g.value==!0?I.value="접기":I.value="펼치기"}const p=l;async function F(){const o=await A();(await fetch(`http://${f}/api/postlike/check/${p.post.postId}/${o}`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${d}`},credentials:"include"})).ok?P():console.error()}async function q(){const o=await A();(await fetch(`http://${f}/api/poststar/check/${p.post.postId}/${o}`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${d}`},credentials:"include"})).ok?S():console.error()}async function P(){const o=p.post.postId,t=await fetch(`http://${f}/api/postlike/read/${o}`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${d}`},credentials:"include"});t.ok||console.error();const i=await t.json();L.value=i}async function S(){const o=p.post.postId,t=await fetch(`http://${f}/api/poststar/read/${o}`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${d}`},credentials:"include"});t.ok||console.error();const i=await t.json();M.value=i}async function J(o){const t=await A();confirm("삭제하시겠습니까?")&&((await fetch(`http://${f}/api/post/delete/${o}/${t}`,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:`Bearer ${d}`},credentials:"include"})).ok?(alert("삭제되었습니다."),window.location.reload()):(console.error(),alert("삭제할 수 없습니다.")))}const j=r([]);async function K(){const o=p.post.postId,t=await fetch(`http://${f}/api/tagpost/read/${o}`,{method:"GET",headers:{Authorization:`Bearer ${d}`},credentials:"include"});t.ok||console.error();const i=await t.text();j.value=i}const Q=tt();function W(o){Q.push({path:`/updatepost/${o}`})}async function X(){const o=await fetch(`http://${b}/api/whoAreYou/${p.post.userId}`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${d}`},credentials:"include"});o.ok||alert("인증에 실패하였습니다.");const t=await o.json();x.value=t}const x=r([]);return P(),S(),K(),X(),(o,t)=>{const i=D("VIconBtn"),T=D("font-awesome-icon"),V=D("IConBtn");return y(),k("div",null,[n("div",{ref_key:"elementRef",ref:m,style:H({"z-index":e(v)?1e3:"auto"})},[s(pt,{style:{"margin-bottom":"10px"},class:"position-relative"},{default:a(()=>[s(e(ct),null,{default:a(()=>[s(e(C),{class:"mb-2"},{default:a(()=>[s(e(C),{class:"post-details"},{default:a(()=>[n("div",ft,[s(e(C),{class:"post-header"},{default:a(()=>[n("div",mt,[n("span",ht,[n("img",{class:"propile-img",src:e(x).profile?e(N)+e(x).profile:e(it)},null,8,yt)]),n("span",_t,c(e(x).username),1),gt,n("span",vt,c(O(l.post.postCreateDt)),1),s(i,{style:{"margin-left":"auto"}},{default:a(()=>[s(e(et),{ref:"postoptionactivator",icon:"ri-more-line",style:{cursor:"pointer"}},null,512),s(lt,{modelValue:e(B),"onUpdate:modelValue":t[2]||(t[2]=u=>st(B)?B.value=u:null),activator:o.$refs.postoptionactivator,location:"bottom end",width:"auto",offset:"5px"},{default:a(()=>[s(rt,null,{default:a(()=>[s(R,{link:""},{default:a(()=>[s(G,{onClick:t[0]||(t[0]=u=>W(l.post.postId)),style:{"font-size":"small"}},{default:a(()=>[_(" 수정 ")]),_:1})]),_:1}),s(R,{link:""},{default:a(()=>[s(G,{onClick:t[1]||(t[1]=u=>J(l.post.postId)),style:{"font-size":"small"}},{default:a(()=>[_(" 삭제 ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","activator"])]),_:1})])]),_:1})]),n("div",kt,[s(dt,{style:{"font-weight":"700"}},{default:a(()=>[_(c(l.post.postTitle),1)]),_:1})]),s(e(ut)),s(e(C),{class:"post-content, mt-2",style:{"margin-left":"5px"}},{default:a(()=>{var u,z;return[e(g)?$("",!0):(y(),k("div",$t,[n("div",null,[n("span",{class:"mb-1",innerHTML:((u=l.post.postContent)==null?void 0:u.length)>100?l.post.postContent.slice(0,100)+" ...":l.post.postContent},null,8,Ct),((z=l.post.postContent)==null?void 0:z.length)>100?(y(),ot(i,{key:0,class:"detailContent ml-2",onClick:E},{default:a(()=>[_(c(e(I)),1)]),_:1})):$("",!0)]),n("div",wt,[n("span",It," #"+c(e(j)),1)])])),e(g)?(y(),k("div",xt,[n("div",null,[n("span",{class:"mb-1",innerHTML:l.post.postContent},null,8,Tt),s(i,{class:"detailContent ml-2",onClick:E},{default:a(()=>[_(c(e(I)),1)]),_:1})]),n("div",Vt,[n("span",zt," #"+c(e(j)),1)])])):$("",!0)]}),_:1}),s(e(C),{style:{"margin-left":"6px",display:"flex"}},{default:a(()=>[s(V,{onClick:F,style:{cursor:"pointer"}},{default:a(()=>[s(T,{icon:["far","thumbs-up"]})]),_:1}),n("span",At,c(e(L)),1),s(V,{onClick:q,style:{cursor:"pointer"}},{default:a(()=>[s(T,{icon:["far","star"]})]),_:1}),n("span",Bt,c(e(M)),1),n("span",jt,[s(i,{style:{color:"#8c57ff",cursor:"pointer"},onClick:U},{default:a(()=>[_(" 댓글 ")]),_:1})])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})],4),e(v)?(y(),k("div",{key:0,class:"modal-wrap",style:H({marginBottom:"20px",zIndex:e(v)?"1000":"1"}),onClick:Y},[n("div",{class:"modal-container",onClick:t[3]||(t[3]=nt(()=>{},["stop"]))},[p.post?(y(),k("div",Dt,[s(at,{post:p.post},null,8,["post"])])):$("",!0)])],4)):$("",!0)])}}};export{Ht as _};
